title: Malware Execution Indicators
id: hayanix-linux-syslog-malware-execution
status: experimental
description: Detects potential malware execution and suspicious process activities
author: Hayanix Team
date: 2025/01/01
modified: 2025/01/01
tags:
    - attack.execution
    - attack.t1059
    - attack.t1204
level: high
logsource:
    category: process
    product: linux
    service: syslog
detection:
    selection:
        message:
            - 'wget.*http://'
            - 'curl.*http://'
            - 'nc.*-l.*-p'
            - 'netcat.*-l.*-p'
            - 'python.*-c.*import'
            - 'perl.*-e.*system'
            - 'bash.*-i.*>&'
            - 'sh.*-i.*>&'
            - 'base64.*-d'
            - 'echo.*|.*sh'
            - 'eval.*\$'
            - 'exec.*\$'
            - 'system.*\$'
            - 'shell_exec.*\$'
            - 'passthru.*\$'
    condition: selection
falsepositives:
    - Legitimate system administration scripts
    - Development and testing activities
    - Automated deployment processes
    - Monitoring and logging tools
fields:
    - message
    - hostname
    - program
    - timestamp
