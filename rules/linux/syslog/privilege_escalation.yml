title: Privilege Escalation Attempts
id: hayanix-linux-syslog-privilege-escalation
status: experimental
description: Detects various privilege escalation attempts and suspicious sudo usage
author: Hayanix Team
date: 2025/01/01
modified: 2025/01/01
tags:
    - attack.privilege_escalation
    - attack.t1548
    - attack.t1055
level: high
logsource:
    category: process
    product: linux
    service: syslog
detection:
    selection:
        message:
            - 'sudo: pam_unix(sudo:auth): authentication failure'
            - 'sudo: .* : TTY=.* ; PWD=.* ; USER=root ; COMMAND='
            - 'sudo: .* : command not allowed'
            - 'su: .* authentication failure'
            - 'su: FAILED SU'
            - 'su: .* to root'
            - 'polkit-agent-helper-1: pam_authenticate failed'
            - 'gdm-password: pam_unix(gdm-password:auth): authentication failure'
    condition: selection
falsepositives:
    - Legitimate administrative tasks
    - Automated systems with sudo access
    - Users forgetting passwords
fields:
    - message
    - hostname
    - program
    - timestamp